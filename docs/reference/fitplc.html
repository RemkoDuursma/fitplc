<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a PLC curve — fitcond â€¢ fitplc</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">fitplc</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a PLC curve</h1>
    </div>

    
    <p>Fit a curve to measurements of stem or leaf conductivity at various water potentials. If measurements are organized as 'percent loss conductivity' (PLC), use the <code>fitplc</code> function. If they are organized as the actual conductance or conductivity (as is common for leaf hydraulic  conductance data, for example), use the <code>fitcond</code> function. You can choose to either fit the Weibull function (the default), or the sigmoidal-exponential model. See Details and Examples for more information on how to use these functions.</p>
<p>It is also possible to fit multiple curves at once, for example one for each species or site, with the <code>fitplcs</code> and <code>fitconds</code> functions. This is useful when you have data for multiple curves organized in one file.</p>
<p>Random effects may be incorporated via the <code>random</code> argument (see Examples), in which case <code>nlme</code> will be used (in case of the Weibull), or <code>lme</code> (in case of the sigmoidal model).</p>
<p>See <code><a href='plot.plcfit.html'>plot.plcfit</a></code> for documentation on plotting methods for the fitted objects, and the examples below.</p>
    

    <pre class="usage"><span class='fu'>fitcond</span>(<span class='no'>dfr</span>, <span class='kw'>varnames</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>K</span> <span class='kw'>=</span> <span class='st'>"K"</span>, <span class='kw'>WP</span> <span class='kw'>=</span> <span class='st'>"MPa"</span>), <span class='kw'>Kmax</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>WP_Kmax</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>rescale_Px</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>fitplc</span>(<span class='no'>dfr</span>, <span class='kw'>varnames</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>PLC</span> <span class='kw'>=</span> <span class='st'>"PLC"</span>, <span class='kw'>WP</span> <span class='kw'>=</span> <span class='st'>"MPa"</span>), <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>random</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Weibull"</span>, <span class='st'>"sigmoidal"</span>, <span class='st'>"loess"</span>), <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>coverage</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>bootci</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>nboot</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>startvalues</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>shift_zero_min</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>loess_span</span> <span class='kw'>=</span> <span class='fl'>0.7</span>, <span class='no'>...</span>)

<span class='fu'>fitplcs</span>(<span class='no'>dfr</span>, <span class='no'>group</span>, <span class='no'>...</span>)

<span class='fu'>fitconds</span>(<span class='no'>dfr</span>, <span class='no'>group</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dfr</th>
      <td><p>A dataframe that contains water potential and plc or conductivity/conductance data.</p></td>
    </tr>
    <tr>
      <th>varnames</th>
      <td><p>A vector specifying the names of the PLC and water potential data (see Examples).</p></td>
    </tr>
    <tr>
      <th>Kmax</th>
      <td><p>Maximum conduct(ance)(ivity), optional (and only when using <code>fitcond</code>). See Examples.</p></td>
    </tr>
    <tr>
      <th>WP_Kmax</th>
      <td><p>Water potential above which Kmax will be calculated from the data. Optional (and only when using <code>fitcond</code>). See Examples.</p></td>
    </tr>
    <tr>
      <th>rescale_Px</th>
      <td><p>Logical (default FALSE). If TRUE, rescales calculation of Px relative to the fitted value of conductance/PLC at the maximum (least negative) water potential in the dataset. Use this argument only when you know exactly what that means. Identical to <code>rescale_Px</code> argument in <code><a href='getPx.html'>getPx</a></code>.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Further parameters passed to <code>fitplc</code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>A variable used as weights that must be present in the dataframe (unquoted, see examples).</p></td>
    </tr>
    <tr>
      <th>random</th>
      <td><p>Variable that specifies random effects (unquoted; must be present in dfr).</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Either 'Weibull' or 'sigmoidal'. See Details.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>If the P50 is to be returned, x = 50. Set this value if other points of the PLC curve should be estimated (although probably more robustly done via <code><a href='getPx.html'>getPx</a></code>).</p></td>
    </tr>
    <tr>
      <th>coverage</th>
      <td><p>The coverage of the confidence interval for the parameters (0.95 is the default).</p></td>
    </tr>
    <tr>
      <th>bootci</th>
      <td><p>If TRUE, also computes the bootstrap confidence interval.</p></td>
    </tr>
    <tr>
      <th>nboot</th>
      <td><p>The number of bootstrap replicates used for calculating confidence intervals.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Logical (default FALSE), if TRUE, don't print any messages.</p></td>
    </tr>
    <tr>
      <th>startvalues</th>
      <td><p>Obsolete - starting values for Weibull now estimated from sigmoidal model fit.</p></td>
    </tr>
    <tr>
      <th>shift_zero_min</th>
      <td><p>Logical (default FALSE). If TRUE, shifts the water potential data so that the highest (least negative) value measured is set to zero. This has consequences for estimation of Kmax, and is only used for <code>fitcond</code>.</p></td>
    </tr>
    <tr>
      <th>loess_span</th>
      <td><p>Only used when <code>model="loess"</code>, the span parameter setting the desired degree of smoothness (see <code>loess</code>).</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Character; variable in the dataframe that specifies groups. The curve will be fit for every group level.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Models</strong> - 
The Weibull model is fit as reparameterized by Ogle et al. (2009), using non-linear regression (<code>nls</code>) or a non-linear mixed-effects model if a random effect is present (<code>nlme</code>). The sigmoidal-exponential model follows the 
specification by Pammenter and van Willigen (1998) : PLC is log-transformed so a linear fit can be obtained with <code>lm</code> or <code>lme</code> in the presence of a random effect. 
Parameters estimated are PX (water potential at which X<!-- % conductivity is lost) and SX  -->
(slope of PLC vs. water potential at P50, MPa per percent). For the sigmoidal model, SX is a parameter combination (and so is PX when x is not 50), so only bootstrap estimates of the confidence intervals are given.
    <strong>Bootstrap</strong> - 
We recommend, where possible, to use the bootstrapped confidence intervals for inference (use at least ca 1000 resamples). For the Weibull model, this is only possible when a sufficiently large sample size is available for a single curve (otherwise too many nls fits will fail). For the sigmoidal model, however, bootstrap is always possible and will always be employed (it cannot be turned off).
    <strong>Confidence intervals</strong> - 
Calculation of confidence intervals (CI) depends on the method chosen. For the Weibull model, the CI based on profiling ('Normal approximation') is always performed, and a non-parametric bootstrap when <code>bootci=TRUE</code>. Both are output in <code>coef</code>, and the bootstrap CI is used in plotting unless otherwise specified (see <code><a href='plot.plcfit.html'>plot.plcfit</a></code>). When a random effect is specified (for the Weibull model), the CI is calculated with <code>intervals.lme</code>. For the sigmoidal model, PX and SX are functions of parameters of a linearized fit, and we thus always use the bootstrap when no random effect is present (it cannot be switched off). When a random effect is included in the sigmoidal model, we use <code>deltaMethod</code> from the <code>car</code> package.
    <strong>Weights</strong> - 
If a variable with the name Weights is present in the dataframe, this variable will be used as the <code>weights</code> argument to perform weighted (non-linear) regression. See Examples on how to use this.
    <strong>Random effects</strong> - 
If the <code>random</code> argument specifies a factor variable present in the dataframe, random effects will be estimated both for SX and PX. This affects <code>coef</code> as well as the confidence intervals for the fixed effects. For both the Weibull model and the sigmoidal model, only the random intercept terms are estimated (i.e. <code>random=~1|group</code>).</p>
<p>A plot method is available for the fitted object, see Examples below.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># We use the built-in example dataset 'stemvul' in the examples below. See ?stemvul.</span>
<span class='co'># Most examples will fit the Weibull model (the default); try running some of the examples</span>
<span class='co'># with 'model="sigmoidal"' and compare the results.</span>

<span class='co'># 1. Fit one species (or fit all, see next example)</span>
<span class='no'>dfr1</span> <span class='kw'>&lt;-</span> <span class='fu'>subset</span>(<span class='no'>stemvul</span>, <span class='no'>Species</span> <span class='kw'>==</span><span class='st'>"dpap"</span>)

<span class='co'># Fit Weibull model. Store results in object 'pfit'</span>
<span class='co'># 'varnames' specifies the names of the 'PLC' variable in the dataframe,</span>
<span class='co'># and water potential (WP). </span>
<span class='co'># In this example, we use only 50 bootstrap replicates but recommend you set this</span>
<span class='co'># to 1000 or so.</span>
<span class='no'>pfit</span> <span class='kw'>&lt;-</span> <span class='fu'>fitplc</span>(<span class='no'>dfr1</span>, <span class='kw'>varnames</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>PLC</span><span class='kw'>=</span><span class='st'>"PLC"</span>, <span class='kw'>WP</span><span class='kw'>=</span><span class='st'>"MPa"</span>), <span class='kw'>nboot</span><span class='kw'>=</span><span class='fl'>50</span>)

<span class='co'># Look at fit</span>
<span class='no'>pfit</span></div><div class='output co'>#&gt; Class of object 'plcfit' as returned by 'fitplc'.
#&gt; -------------------------------------------------
#&gt; 
#&gt; Parameters and %s%% confidence interval:
#&gt; 
#&gt;  95%    Estimate Norm - 2.5% Norm - 97.5% Boot - 2.5% Boot - 97.5%
#&gt; SX 27.639042   19.016029    38.636204   16.745048    35.622913
#&gt; PX  2.631328    2.310614     2.955739    2.391684     2.975172
#&gt; </div><div class='input'>
<span class='co'># Make a standard plot. The default plot is 'relative conductivity',</span>
<span class='co'># (which is 1.0 where PLC = 0). For plotting options, see ?plot.plcfit</span>
<span class='fu'>plot</span>(<span class='no'>pfit</span>)</div><div class='img'><img src='fitplc-25.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Or plot the percent embolism</span>
<span class='fu'>plot</span>(<span class='no'>pfit</span>, <span class='kw'>what</span><span class='kw'>=</span><span class='st'>"embol"</span>)</div><div class='img'><img src='fitplc-26.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Get the coefficients of the fit.</span>
<span class='fu'>coef</span>(<span class='no'>pfit</span>)</div><div class='output co'>#&gt;     Estimate Norm - 2.5% Norm - 97.5% Boot - 2.5% Boot - 97.5%
#&gt; SX 27.639042   19.016029    38.636204   16.745048    35.622913
#&gt; PX  2.631328    2.310614     2.955739    2.391684     2.975172</div><div class='input'>
<span class='co'># Repeat for the sigmoidal model</span>
<span class='co'># Note that varnames specification above is the same as the default, so it </span>
<span class='co'># can be omitted.</span>
<span class='no'>pfit2</span> <span class='kw'>&lt;-</span> <span class='fu'>fitplc</span>(<span class='no'>dfr1</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='st'>"sigmoid"</span>)
<span class='fu'>plot</span>(<span class='no'>pfit2</span>)</div><div class='img'><img src='fitplc-27.png' alt='' width='700' height='432.632880098887' /></div><div class='input'><span class='fu'>coef</span>(<span class='no'>pfit2</span>)</div><div class='output co'>#&gt;     Estimate Boot - 2.5% Boot - 97.5%
#&gt; SX 25.287577   17.559690    33.264051
#&gt; PX  2.857665    2.537777     3.194784</div><div class='input'>
<span class='co'># 2. Fit all species in the dataset.</span>
<span class='co'># Here we also set the starting values (which is sometimes needed).</span>
<span class='co'># In this example, we use only 50 bootstrap replicates but recommend you set this</span>
<span class='co'># to 1000 or so. </span>
<span class='no'>allfit</span> <span class='kw'>&lt;-</span> <span class='fu'>fitplcs</span>(<span class='no'>stemvul</span>, <span class='st'>"Species"</span>, <span class='kw'>varnames</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>PLC</span><span class='kw'>=</span><span class='st'>"PLC"</span>, <span class='kw'>WP</span><span class='kw'>=</span><span class='st'>"MPa"</span>), <span class='kw'>nboot</span><span class='kw'>=</span><span class='fl'>50</span>)

<span class='co'># 3. Plot the fits.</span>
<span class='fu'>plot</span>(<span class='no'>allfit</span>, <span class='kw'>onepanel</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>plotci</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>px_ci</span><span class='kw'>=</span><span class='st'>"none"</span>, <span class='kw'>pxlinecol</span><span class='kw'>=</span><span class='st'>"dimgrey"</span>)</div><div class='img'><img src='fitplc-28.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># Coefficients show the estimates and 95% CI (given by 'lower' and 'upper')</span>
<span class='co'># Based on the CI's, species differences can be decided.</span>
<span class='fu'>coef</span>(<span class='no'>allfit</span>)</div><div class='output co'>#&gt;   Group Parameter  Estimate Norm - 2.5% Norm - 97.5% Boot - 2.5% Boot - 97.5%
#&gt; 1  dpap        SX 27.639042   19.016029    38.636204   22.052236    37.583669
#&gt; 2  dpap        PX  2.631328    2.310614     2.955739    2.305253     2.923221
#&gt; 3 egran        SX 38.762203   24.503730    65.558933   26.872801    94.308415
#&gt; 4 egran        PX  3.058613    2.762927     3.370941    2.610811     3.347017
#&gt; 5  ssay        SX 46.221391   24.890293    80.460977   17.976285    67.887883
#&gt; 6  ssay        PX  2.104288    1.779723     2.355404    1.935252     2.424353</div><div class='input'>
<span class='co'># 3. Specify Weights. The default variable name is Weights, if present in the dataset</span>
<span class='co'># it will be used for weighted non-linear regression</span>
<span class='co'># In this example, we use only 50 bootstrap replicates but recommend you set this</span>
<span class='co'># to 1000 or so. </span>
<span class='no'>dfr1</span>$<span class='no'>Weights</span> <span class='kw'>&lt;-</span> <span class='fu'>abs</span>(<span class='fl'>50</span>-<span class='no'>dfr1</span>$<span class='no'>PLC</span>)^<span class='fl'>1.2</span>
<span class='no'>pfit</span> <span class='kw'>&lt;-</span> <span class='fu'>fitplc</span>(<span class='no'>dfr1</span>, <span class='kw'>varnames</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>PLC</span><span class='kw'>=</span><span class='st'>"PLC"</span>, <span class='kw'>WP</span><span class='kw'>=</span><span class='st'>"MPa"</span>), <span class='kw'>weights</span><span class='kw'>=</span><span class='no'>Weights</span>, <span class='kw'>nboot</span><span class='kw'>=</span><span class='fl'>50</span>)
<span class='fu'>coef</span>(<span class='no'>pfit</span>)</div><div class='output co'>#&gt;     Estimate Norm - 2.5% Norm - 97.5% Boot - 2.5% Boot - 97.5%
#&gt; SX 40.145239   30.607389    54.544789   29.595346    53.733330
#&gt; PX  2.602145    2.339932     2.871339    2.288247     2.850159</div><div class='input'>
<span class='co'># 4. Fit the Weibull curve directly to the raw conductance data. </span>
<span class='co'># Use this option when you don't want to transform your data to PLC. </span>
<span class='co'># You have two options: specify the 'maximum' conductance yourself (and provide Kmax), </span>
<span class='co'># or set the threshold water potential (Kmax_WP), which is then used to calculate Kmax</span>
<span class='co'># (from the average of the conductance values where WP &gt; Kmax_WP).</span>

<span class='co'># Option 1 : maximum conductivity (i.e. at full hydration) is known, and used as input.</span>
<span class='no'>kfit1</span> <span class='kw'>&lt;-</span> <span class='fu'>fitcond</span>(<span class='no'>dfr1</span>, <span class='kw'>varnames</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>K</span><span class='kw'>=</span><span class='st'>"Cond"</span>, <span class='kw'>WP</span><span class='kw'>=</span><span class='st'>"MPa"</span>), <span class='kw'>Kmax</span><span class='kw'>=</span><span class='fl'>7.2</span>, <span class='kw'>nboot</span><span class='kw'>=</span><span class='fl'>50</span>)

<span class='co'># Option 2 : calculate maximum cond. from data where water potential : -0.3 MPa.</span>
<span class='co'># In this example, we use only 50 bootstrap replicates but recommend you set this</span>
<span class='co'># to 1000 or so. </span>
<span class='no'>kfit2</span> <span class='kw'>&lt;-</span> <span class='fu'>fitcond</span>(<span class='no'>dfr1</span>, <span class='kw'>varnames</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='kw'>K</span><span class='kw'>=</span><span class='st'>"Cond"</span>, <span class='kw'>WP</span><span class='kw'>=</span><span class='st'>"MPa"</span>), <span class='kw'>WP_Kmax</span> <span class='kw'>=</span> -<span class='fl'>0.3</span>, <span class='kw'>nboot</span><span class='kw'>=</span><span class='fl'>50</span>)
<span class='co'># Use plot(kfit1) as for fitplc, as well as coef() etc.</span>

<span class='co'># Fit multiple conductivity curves at once (bootstrap omitted for speed).</span>
<span class='no'>kfits3</span> <span class='kw'>&lt;-</span> <span class='fu'>fitconds</span>(<span class='no'>stemvul</span>, <span class='st'>"Species"</span>, <span class='kw'>varnames</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>K</span><span class='kw'>=</span><span class='st'>"Cond"</span>, <span class='kw'>WP</span><span class='kw'>=</span><span class='st'>"MPa"</span>), <span class='kw'>WP_Kmax</span><span class='kw'>=</span>-<span class='fl'>0.3</span>, <span class='kw'>boot</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>plot</span>(<span class='no'>kfits3</span>, <span class='kw'>onepanel</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>12</span>), <span class='kw'>px_ci</span><span class='kw'>=</span><span class='st'>"none"</span>)</div><div class='img'><img src='fitplc-29.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'># 5. Random effects.</span>
<span class='co'># This example takes into account the fact that the individual data points for a species are not </span>
<span class='co'># independent, but rather clustered by branch. </span>
<span class='no'>fitr</span> <span class='kw'>&lt;-</span> <span class='fu'>fitplc</span>(<span class='no'>dfr1</span>, <span class='kw'>random</span><span class='kw'>=</span><span class='no'>Branch</span>)

<span class='co'># Visualize the random effects.</span>
<span class='fu'>plot</span>(<span class='no'>fitr</span>, <span class='kw'>plotrandom</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='img'><img src='fitplc-30.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Remko Duursma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
