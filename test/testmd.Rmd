---
title: "fitplc test"
output: 
  html_document:
    code_fold: hide
---

```{r, cache=FALSE}
library(fitplc)

dpap <- subset(stemvul, Species == "dpap")

Xval <- 72
cover <- 0.81245

f <- fitplc(dpap, x=Xval, coverage=cover)
g <- fitplc(dpap, bootci=FALSE, x=Xval, coverage=cover)
h <- fitplc(dpap, model="sigm", x=Xval, coverage=cover)

k <- fitplc(stemvul, random=Species, x=Xval, coverage=cover)
m <- fitplc(stemvul, random=Species, model="sigm", x=Xval, coverage=cover)
m0 <- fitplc(stemvul, model="sigm", x=Xval, coverage=cover)

h1 <- fitplcs(stemvul, group="Species", x=Xval, coverage=cover)
h2 <- fitplcs(stemvul, group="Species", x=Xval, model="sigmoid", coverage=cover)

fc1 <- fitcond(dpap, WP_Kmax=0.5, varnames=c(K="Cond", WP="MPa"), 
               x=Xval, coverage=cover)
fc2 <- fitcond(dpap, WP_Kmax=0.5, varnames=c(K="Cond", WP="MPa"), 
               model="sigmoid", x=Xval, coverage=cover)
```


```{r, fig.width=5, fig.height=4}
plot(f)
plot(f, what="PLC")
```

```{r, fig.width=5, fig.height=4}
plot(g)
plot(g, what="PLC")
```

```{r, fig.width=5, fig.height=4}
plot(h)
plot(h, what="PLC")
```

```{r, fig.width=5, fig.height=4}
plot(k, plotrandom=TRUE)
plot(k, plotrandom=FALSE)
coef(k)
```

```{r, fig.width=5, fig.height=4}
plot(m, plotrandom=F)
plot(m, plotrandom=T)
coef(m)
```

```{r, fig.width=5, fig.height=4}
plot(m0)
coef(m0)
```

```{r, fig.width=5, fig.height=4}
plot(fc1)
coef(fc1)
summary(fc1)
```


```{r, fig.width=5, fig.height=4}
plot(fc2)
coef(fc2)
summary(fc2)
```


```{r, fig.width=5, fig.height=4}
plot(h1, onepanel=TRUE, selines="none", plotci=FALSE)
abline(h=0.5)
coef(h1)
```


```{r, fig.width=5, fig.height=4}
plot(h2, onepanel=TRUE, selines="none", plotci=FALSE)
abline(h=0.5)
coef(h2)
```

```{r, fig.width=5, fig.height=4}
pira <- read.csv("c:/repos/fitplcpaper/data/Pinus_radiata_centrifuge.csv")
f4 <- fitplc(pira, varnames=c(PLC="PLC",WP="Psi"),
             random=Rep)
plot(f4)
coef(f4)
```


```{r}
fun <- function(object)print(getPx(object, x=c(12,50,88)))

lapply(list(f,g,h,k,m),fun)
```


```{r}
plot(f, px_ci="parametric")
plot(h, px_ci="parametric")

```


